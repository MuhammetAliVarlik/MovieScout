<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>MovieScout - Find Similar Movies</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="../static//css/styles.css">
        <link rel="stylesheet" href="../static//scss/global.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" 
        rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    </head>
    <body class="bg-dark">
        <div class="background-image">

        </div>
        <!-- Navbar with background image -->
        <nav class="navbar navbar-expand-lg bg-black" id="navbar">
            <div class="container-fluid">
                <a class="navbar-brand " href="#">MovieScout</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav">
                        <li class="nav-item" >
                            <a class="nav-link active" aria-current="page" href="#">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Services</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Contact</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="demo mt-3">
            <div class="demo__content">
              <div class="demo__card-cont">
                {% if recommendations %}
                {% for movie in recommendations %}
                <div class="demo__card">
                    <div class="d-flex flex-column justify-content-center align-items-center demo__card__top bg-black rounded-top-3" style="position: relative;">
                        <!-- Similarity Score -->
                        <div class="similarity-score position-absolute top-0 end-0 p-2 text-white rounded-3 me-3 mt-3 {{ 'high-similarity' if movie['similarity_score']*100 >= 80 else 'medium-similarity' if movie['similarity_score']*100 >= 50 else 'low-similarity' }}" style="z-index: 10;">
                            {{ (movie['similarity_score']*100) | round(1) }}%
                        </div>
                        
                        <!-- Background image with blur -->
                        <img src="https://image.tmdb.org/t/p/w500/{{ movie['backdrop_path'] }}" class="img-fluid demo__card__img rounded-top-3 position-absolute top-0 start-0" style="width: auto; height: 100%; filter: blur(1px); -webkit-filter: blur(1px); opacity: 0.6;">
                        
                        <!-- Poster image -->
                        <img src="https://image.tmdb.org/t/p/w200/{{ movie['poster_path'] }}" class="img-fluid demo__card__img m-3 rounded-3 position-absolute bottom-0 start-0">
                    </div>
                    
                    
                    
                    <!-- Alt bölüm için içerik düzeni -->
                    <div class="demo__card__btm bg-black p-3 rounded-bottom-3">
                        <div class="container">
                            
                            <div class="row">
                                
                                
                                <div class="col-12">
                                    <!-- Başlık için daha büyük font ve border altı -->
                                    <p class="demo__card__we text-white rounded position-relative top-0 start-0 fw-bold pb-2 mb-2" style="font-size: 1.1rem; line-height: 1.5rem;">{{ movie['title'] }}</p>
                                </div>
                                <div class="col-12">
                                    <!-- Açıklama için küçük font ve border altı -->
                                    <p class="demo__card__we text-white position-relative top-0 start-0 pb-2 mb-2" style="font-size: 0.8rem; line-height: 1.2rem; border-bottom: 0.1rem rgba(255,255,255,0.1) solid; 
                                    display: -webkit-box; -webkit-line-clamp: 6; -webkit-box-orient: vertical; overflow: hidden; height: 7.2rem;">
                                        {{ movie['overview'] }}
                                    </p>
                                </div>
                                <div class="col-12">
                                    <!-- Tarih ve tür için küçük font ve border altı -->
                                    <p class="demo__card__we text-white position-relative top-0 start-0 pb-2 mb-2" style="font-size: 0.8rem; line-height: 1.2rem; border-bottom: 0.1rem rgba(255,255,255,0.1) solid;">
                                        {{ movie['release_date'][:4] }} | {{ movie['genres'] }}
                                    </p>
                                </div>
                
                                <div class="col-12 d-flex align-items-center">
                                    <span class="text-warning fs-3 me-2">
                                        {% set stars = (movie['vote_average'] / 2) | round(0) %}
                                        {% for i in range(5) %}
                                            {% if i < stars %}
                                                ★
                                            {% else %}
                                                ☆
                                            {% endif %}
                                        {% endfor %}
                                    </span>
                                    <span class="text-white fs-6">
                                        ({{ (movie['vote_average'] / 2) | round(1) }})
                                    </span>
                                </div>
                                
                                
                                
                            </div>
                        </div>
                    </div>
                    
                    <!-- Card choices -->
                    <div class="demo__card__choice m--reject"></div>
                    <div class="demo__card__choice m--like"></div>
                    <div class="demo__card__drag"></div>
                </div>
                
                
                
                {% endfor %}
                {% else %}
                <p>No recommendations available.</p>
                {% endif %}

              </div>
            </div>
          </div>
          
          


        </div>
        <script type="module" src="{{url_for('static', filename='js/index.js')}}"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script>
                $(document).ready(function() {

                var animating = false;
                var cardsCounter = 0;
                var numOfCards = 6;
                var decisionVal = 80;
                var pullDeltaX = 0;
                var deg = 0;
                var $card, $cardReject, $cardLike;

                function pullChange() {
                animating = true;
                deg = pullDeltaX / 10;
                $card.css("transform", "translateX("+ pullDeltaX +"px) rotate("+ deg +"deg)");

                var opacity = pullDeltaX / 100;
                var rejectOpacity = (opacity >= 0) ? 0 : Math.abs(opacity);
                var likeOpacity = (opacity <= 0) ? 0 : opacity;
                $cardReject.css("opacity", rejectOpacity);
                $cardLike.css("opacity", likeOpacity);
                };

                function release() {

                if (pullDeltaX >= decisionVal) {
                    $card.addClass("to-right");
                } else if (pullDeltaX <= -decisionVal) {
                    $card.addClass("to-left");
                }

                if (Math.abs(pullDeltaX) >= decisionVal) {
                    $card.addClass("inactive");

                    setTimeout(function() {
                    $card.addClass("below").removeClass("inactive to-left to-right");
                    cardsCounter++;
                    if (cardsCounter === numOfCards) {
                        cardsCounter = 0;
                        $(".demo__card").removeClass("below");
                    }
                    }, 300);
                }

                if (Math.abs(pullDeltaX) < decisionVal) {
                    $card.addClass("reset");
                }

                setTimeout(function() {
                    $card.attr("style", "").removeClass("reset")
                    .find(".demo__card__choice").attr("style", "");

                    pullDeltaX = 0;
                    animating = false;
                }, 300);
                };

                $(document).on("mousedown touchstart", ".demo__card:not(.inactive)", function(e) {
                if (animating) return;

                $card = $(this);
                $cardReject = $(".demo__card__choice.m--reject", $card);
                $cardLike = $(".demo__card__choice.m--like", $card);
                var startX =  e.pageX || e.originalEvent.touches[0].pageX;

                $(document).on("mousemove touchmove", function(e) {
                    var x = e.pageX || e.originalEvent.touches[0].pageX;
                    pullDeltaX = (x - startX);
                    if (!pullDeltaX) return;
                    pullChange();
                });

                $(document).on("mouseup touchend", function() {
                    $(document).off("mousemove touchmove mouseup touchend");
                    if (!pullDeltaX) return; // prevents from rapid click events
                    release();
                });
                });

                });
        </script>
    </body>
</html>
